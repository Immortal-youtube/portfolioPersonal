{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.FindOperation = void 0;\n\nconst error_1 = require(\"../error\");\n\nconst read_concern_1 = require(\"../read_concern\");\n\nconst sort_1 = require(\"../sort\");\n\nconst utils_1 = require(\"../utils\");\n\nconst command_1 = require(\"./command\");\n\nconst operation_1 = require(\"./operation\");\n/** @internal */\n\n\nclass FindOperation extends command_1.CommandOperation {\n  constructor(collection, ns) {\n    let filter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    super(collection, options);\n    this.options = options;\n    this.ns = ns;\n\n    if (typeof filter !== 'object' || Array.isArray(filter)) {\n      throw new error_1.MongoInvalidArgumentError('Query filter must be a plain object or ObjectId');\n    } // If the filter is a buffer, validate that is a valid BSON document\n\n\n    if (Buffer.isBuffer(filter)) {\n      const objectSize = filter[0] | filter[1] << 8 | filter[2] << 16 | filter[3] << 24;\n\n      if (objectSize !== filter.length) {\n        throw new error_1.MongoInvalidArgumentError(`Query filter raw message size does not match message header size [${filter.length}] != [${objectSize}]`);\n      }\n    } // special case passing in an ObjectId as a filter\n\n\n    this.filter = filter != null && filter._bsontype === 'ObjectID' ? {\n      _id: filter\n    } : filter;\n  }\n\n  execute(server, session, callback) {\n    this.server = server;\n    const options = this.options;\n    let findCommand = makeFindCommand(this.ns, this.filter, options);\n\n    if (this.explain) {\n      findCommand = (0, utils_1.decorateWithExplain)(findCommand, this.explain);\n    }\n\n    server.command(this.ns, findCommand, { ...this.options,\n      ...this.bsonOptions,\n      documentsReturnedIn: 'firstBatch',\n      session\n    }, callback);\n  }\n\n}\n\nexports.FindOperation = FindOperation;\n\nfunction makeFindCommand(ns, filter, options) {\n  const findCommand = {\n    find: ns.collection,\n    filter\n  };\n\n  if (options.sort) {\n    findCommand.sort = (0, sort_1.formatSort)(options.sort);\n  }\n\n  if (options.projection) {\n    let projection = options.projection;\n\n    if (projection && Array.isArray(projection)) {\n      projection = projection.length ? projection.reduce((result, field) => {\n        result[field] = 1;\n        return result;\n      }, {}) : {\n        _id: 1\n      };\n    }\n\n    findCommand.projection = projection;\n  }\n\n  if (options.hint) {\n    findCommand.hint = (0, utils_1.normalizeHintField)(options.hint);\n  }\n\n  if (typeof options.skip === 'number') {\n    findCommand.skip = options.skip;\n  }\n\n  if (typeof options.limit === 'number') {\n    if (options.limit < 0) {\n      findCommand.limit = -options.limit;\n      findCommand.singleBatch = true;\n    } else {\n      findCommand.limit = options.limit;\n    }\n  }\n\n  if (typeof options.batchSize === 'number') {\n    if (options.batchSize < 0) {\n      if (options.limit && options.limit !== 0 && Math.abs(options.batchSize) < Math.abs(options.limit)) {\n        findCommand.limit = -options.batchSize;\n      }\n\n      findCommand.singleBatch = true;\n    } else {\n      findCommand.batchSize = options.batchSize;\n    }\n  }\n\n  if (typeof options.singleBatch === 'boolean') {\n    findCommand.singleBatch = options.singleBatch;\n  } // we check for undefined specifically here to allow falsy values\n  // eslint-disable-next-line no-restricted-syntax\n\n\n  if (options.comment !== undefined) {\n    findCommand.comment = options.comment;\n  }\n\n  if (typeof options.maxTimeMS === 'number') {\n    findCommand.maxTimeMS = options.maxTimeMS;\n  }\n\n  const readConcern = read_concern_1.ReadConcern.fromOptions(options);\n\n  if (readConcern) {\n    findCommand.readConcern = readConcern.toJSON();\n  }\n\n  if (options.max) {\n    findCommand.max = options.max;\n  }\n\n  if (options.min) {\n    findCommand.min = options.min;\n  }\n\n  if (typeof options.returnKey === 'boolean') {\n    findCommand.returnKey = options.returnKey;\n  }\n\n  if (typeof options.showRecordId === 'boolean') {\n    findCommand.showRecordId = options.showRecordId;\n  }\n\n  if (typeof options.tailable === 'boolean') {\n    findCommand.tailable = options.tailable;\n  }\n\n  if (typeof options.oplogReplay === 'boolean') {\n    findCommand.oplogReplay = options.oplogReplay;\n  }\n\n  if (typeof options.timeout === 'boolean') {\n    findCommand.noCursorTimeout = !options.timeout;\n  } else if (typeof options.noCursorTimeout === 'boolean') {\n    findCommand.noCursorTimeout = options.noCursorTimeout;\n  }\n\n  if (typeof options.awaitData === 'boolean') {\n    findCommand.awaitData = options.awaitData;\n  }\n\n  if (typeof options.allowPartialResults === 'boolean') {\n    findCommand.allowPartialResults = options.allowPartialResults;\n  }\n\n  if (options.collation) {\n    findCommand.collation = options.collation;\n  }\n\n  if (typeof options.allowDiskUse === 'boolean') {\n    findCommand.allowDiskUse = options.allowDiskUse;\n  }\n\n  if (options.let) {\n    findCommand.let = options.let;\n  }\n\n  return findCommand;\n}\n\n(0, operation_1.defineAspects)(FindOperation, [operation_1.Aspect.READ_OPERATION, operation_1.Aspect.RETRYABLE, operation_1.Aspect.EXPLAINABLE, operation_1.Aspect.CURSOR_CREATING]);","map":{"version":3,"mappings":"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","names":["FindOperation","command_1","constructor","collection","ns","filter","options","Array","isArray","error_1","Buffer","isBuffer","objectSize","length","_bsontype","_id","execute","server","session","callback","findCommand","makeFindCommand","explain","command","bsonOptions","documentsReturnedIn","exports","find","sort","projection","reduce","result","field","hint","skip","limit","singleBatch","batchSize","Math","abs","comment","undefined","maxTimeMS","readConcern","read_concern_1","fromOptions","toJSON","max","min","returnKey","showRecordId","tailable","oplogReplay","timeout","noCursorTimeout","awaitData","allowPartialResults","collation","allowDiskUse","let","operation_1","READ_OPERATION","RETRYABLE","EXPLAINABLE","CURSOR_CREATING"],"sources":["C:\\Users\\anshs\\OneDrive\\Documents\\Code\\WebDevelopement\\portfolioPersonal\\node_modules\\mongodb\\src\\operations\\find.ts"],"sourcesContent":["import type { Document } from '../bson';\nimport type { Collection } from '../collection';\nimport { MongoInvalidArgumentError } from '../error';\nimport { ReadConcern } from '../read_concern';\nimport type { Server } from '../sdam/server';\nimport type { ClientSession } from '../sessions';\nimport { formatSort, Sort } from '../sort';\nimport { Callback, decorateWithExplain, MongoDBNamespace, normalizeHintField } from '../utils';\nimport { CollationOptions, CommandOperation, CommandOperationOptions } from './command';\nimport { Aspect, defineAspects, Hint } from './operation';\n\n/**\n * @public\n * @typeParam TSchema - Unused schema definition, deprecated usage, only specify `FindOptions` with no generic\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport interface FindOptions<TSchema extends Document = Document> extends CommandOperationOptions {\n  /** Sets the limit of documents returned in the query. */\n  limit?: number;\n  /** Set to sort the documents coming back from the query. Array of indexes, `[['a', 1]]` etc. */\n  sort?: Sort;\n  /** The fields to return in the query. Object of fields to either include or exclude (one of, not both), `{'a':1, 'b': 1}` **or** `{'a': 0, 'b': 0}` */\n  projection?: Document;\n  /** Set to skip N documents ahead in your query (useful for pagination). */\n  skip?: number;\n  /** Tell the query to use specific indexes in the query. Object of indexes to use, `{'_id':1}` */\n  hint?: Hint;\n  /** Specify if the cursor can timeout. */\n  timeout?: boolean;\n  /** Specify if the cursor is tailable. */\n  tailable?: boolean;\n  /** Specify if the cursor is a tailable-await cursor. Requires `tailable` to be true */\n  awaitData?: boolean;\n  /** Set the batchSize for the getMoreCommand when iterating over the query results. */\n  batchSize?: number;\n  /** If true, returns only the index keys in the resulting documents. */\n  returnKey?: boolean;\n  /** The inclusive lower bound for a specific index */\n  min?: Document;\n  /** The exclusive upper bound for a specific index */\n  max?: Document;\n  /** Number of milliseconds to wait before aborting the query. */\n  maxTimeMS?: number;\n  /** The maximum amount of time for the server to wait on new documents to satisfy a tailable cursor query. Requires `tailable` and `awaitData` to be true */\n  maxAwaitTimeMS?: number;\n  /** The server normally times out idle cursors after an inactivity period (10 minutes) to prevent excess memory use. Set this option to prevent that. */\n  noCursorTimeout?: boolean;\n  /** Specify collation (MongoDB 3.4 or higher) settings for update operation (see 3.4 documentation for available fields). */\n  collation?: CollationOptions;\n  /** Allows disk use for blocking sort operations exceeding 100MB memory. (MongoDB 3.2 or higher) */\n  allowDiskUse?: boolean;\n  /** Determines whether to close the cursor after the first batch. Defaults to false. */\n  singleBatch?: boolean;\n  /** For queries against a sharded collection, allows the command (or subsequent getMore commands) to return partial results, rather than an error, if one or more queried shards are unavailable. */\n  allowPartialResults?: boolean;\n  /** Determines whether to return the record identifier for each document. If true, adds a field $recordId to the returned documents. */\n  showRecordId?: boolean;\n  /** Map of parameter names and values that can be accessed using $$var (requires MongoDB 5.0). */\n  let?: Document;\n  /**\n   * Option to enable an optimized code path for queries looking for a particular range of `ts` values in the oplog. Requires `tailable` to be true.\n   * @deprecated Starting from MongoDB 4.4 this flag is not needed and will be ignored.\n   */\n  oplogReplay?: boolean;\n}\n\n/** @internal */\nexport class FindOperation extends CommandOperation<Document> {\n  override options: FindOptions;\n  filter: Document;\n\n  constructor(\n    collection: Collection | undefined,\n    ns: MongoDBNamespace,\n    filter: Document = {},\n    options: FindOptions = {}\n  ) {\n    super(collection, options);\n\n    this.options = options;\n    this.ns = ns;\n\n    if (typeof filter !== 'object' || Array.isArray(filter)) {\n      throw new MongoInvalidArgumentError('Query filter must be a plain object or ObjectId');\n    }\n\n    // If the filter is a buffer, validate that is a valid BSON document\n    if (Buffer.isBuffer(filter)) {\n      const objectSize = filter[0] | (filter[1] << 8) | (filter[2] << 16) | (filter[3] << 24);\n      if (objectSize !== filter.length) {\n        throw new MongoInvalidArgumentError(\n          `Query filter raw message size does not match message header size [${filter.length}] != [${objectSize}]`\n        );\n      }\n    }\n\n    // special case passing in an ObjectId as a filter\n    this.filter = filter != null && filter._bsontype === 'ObjectID' ? { _id: filter } : filter;\n  }\n\n  override execute(\n    server: Server,\n    session: ClientSession | undefined,\n    callback: Callback<Document>\n  ): void {\n    this.server = server;\n\n    const options = this.options;\n\n    let findCommand = makeFindCommand(this.ns, this.filter, options);\n    if (this.explain) {\n      findCommand = decorateWithExplain(findCommand, this.explain);\n    }\n\n    server.command(\n      this.ns,\n      findCommand,\n      {\n        ...this.options,\n        ...this.bsonOptions,\n        documentsReturnedIn: 'firstBatch',\n        session\n      },\n      callback\n    );\n  }\n}\n\nfunction makeFindCommand(ns: MongoDBNamespace, filter: Document, options: FindOptions): Document {\n  const findCommand: Document = {\n    find: ns.collection,\n    filter\n  };\n\n  if (options.sort) {\n    findCommand.sort = formatSort(options.sort);\n  }\n\n  if (options.projection) {\n    let projection = options.projection;\n    if (projection && Array.isArray(projection)) {\n      projection = projection.length\n        ? projection.reduce((result, field) => {\n            result[field] = 1;\n            return result;\n          }, {})\n        : { _id: 1 };\n    }\n\n    findCommand.projection = projection;\n  }\n\n  if (options.hint) {\n    findCommand.hint = normalizeHintField(options.hint);\n  }\n\n  if (typeof options.skip === 'number') {\n    findCommand.skip = options.skip;\n  }\n\n  if (typeof options.limit === 'number') {\n    if (options.limit < 0) {\n      findCommand.limit = -options.limit;\n      findCommand.singleBatch = true;\n    } else {\n      findCommand.limit = options.limit;\n    }\n  }\n\n  if (typeof options.batchSize === 'number') {\n    if (options.batchSize < 0) {\n      if (\n        options.limit &&\n        options.limit !== 0 &&\n        Math.abs(options.batchSize) < Math.abs(options.limit)\n      ) {\n        findCommand.limit = -options.batchSize;\n      }\n\n      findCommand.singleBatch = true;\n    } else {\n      findCommand.batchSize = options.batchSize;\n    }\n  }\n\n  if (typeof options.singleBatch === 'boolean') {\n    findCommand.singleBatch = options.singleBatch;\n  }\n\n  // we check for undefined specifically here to allow falsy values\n  // eslint-disable-next-line no-restricted-syntax\n  if (options.comment !== undefined) {\n    findCommand.comment = options.comment;\n  }\n\n  if (typeof options.maxTimeMS === 'number') {\n    findCommand.maxTimeMS = options.maxTimeMS;\n  }\n\n  const readConcern = ReadConcern.fromOptions(options);\n  if (readConcern) {\n    findCommand.readConcern = readConcern.toJSON();\n  }\n\n  if (options.max) {\n    findCommand.max = options.max;\n  }\n\n  if (options.min) {\n    findCommand.min = options.min;\n  }\n\n  if (typeof options.returnKey === 'boolean') {\n    findCommand.returnKey = options.returnKey;\n  }\n\n  if (typeof options.showRecordId === 'boolean') {\n    findCommand.showRecordId = options.showRecordId;\n  }\n\n  if (typeof options.tailable === 'boolean') {\n    findCommand.tailable = options.tailable;\n  }\n\n  if (typeof options.oplogReplay === 'boolean') {\n    findCommand.oplogReplay = options.oplogReplay;\n  }\n\n  if (typeof options.timeout === 'boolean') {\n    findCommand.noCursorTimeout = !options.timeout;\n  } else if (typeof options.noCursorTimeout === 'boolean') {\n    findCommand.noCursorTimeout = options.noCursorTimeout;\n  }\n\n  if (typeof options.awaitData === 'boolean') {\n    findCommand.awaitData = options.awaitData;\n  }\n\n  if (typeof options.allowPartialResults === 'boolean') {\n    findCommand.allowPartialResults = options.allowPartialResults;\n  }\n\n  if (options.collation) {\n    findCommand.collation = options.collation;\n  }\n\n  if (typeof options.allowDiskUse === 'boolean') {\n    findCommand.allowDiskUse = options.allowDiskUse;\n  }\n\n  if (options.let) {\n    findCommand.let = options.let;\n  }\n\n  return findCommand;\n}\n\ndefineAspects(FindOperation, [\n  Aspect.READ_OPERATION,\n  Aspect.RETRYABLE,\n  Aspect.EXPLAINABLE,\n  Aspect.CURSOR_CREATING\n]);\n"]},"metadata":{},"sourceType":"script"}