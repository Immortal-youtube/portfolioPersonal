{"ast":null,"code":"import { HttpRequest, HttpResponse } from \"@aws-sdk/protocol-http\";\nimport { getSkewCorrectedDate } from \"./utils/getSkewCorrectedDate\";\nimport { getUpdatedSystemClockOffset } from \"./utils/getUpdatedSystemClockOffset\";\nexport const awsAuthMiddleware = options => (next, context) => async function (args) {\n  if (!HttpRequest.isInstance(args.request)) return next(args);\n  const authScheme = context.endpointV2?.properties?.authSchemes?.[0];\n  const multiRegionOverride = authScheme?.name === \"sigv4a\" ? authScheme?.signingRegionSet?.join(\",\") : undefined;\n  const signer = await options.signer(authScheme);\n  const output = await next({ ...args,\n    request: await signer.sign(args.request, {\n      signingDate: getSkewCorrectedDate(options.systemClockOffset),\n      signingRegion: multiRegionOverride || context[\"signing_region\"],\n      signingService: context[\"signing_service\"]\n    })\n  }).catch(error => {\n    const serverTime = error.ServerTime ?? getDateHeader(error.$response);\n\n    if (serverTime) {\n      options.systemClockOffset = getUpdatedSystemClockOffset(serverTime, options.systemClockOffset);\n    }\n\n    throw error;\n  });\n  const dateHeader = getDateHeader(output.response);\n\n  if (dateHeader) {\n    options.systemClockOffset = getUpdatedSystemClockOffset(dateHeader, options.systemClockOffset);\n  }\n\n  return output;\n};\n\nconst getDateHeader = response => HttpResponse.isInstance(response) ? response.headers?.date ?? response.headers?.Date : undefined;\n\nexport const awsAuthMiddlewareOptions = {\n  name: \"awsAuthMiddleware\",\n  tags: [\"SIGNATURE\", \"AWSAUTH\"],\n  relation: \"after\",\n  toMiddleware: \"retryMiddleware\",\n  override: true\n};\nexport const getAwsAuthPlugin = options => ({\n  applyToStack: clientStack => {\n    clientStack.addRelativeTo(awsAuthMiddleware(options), awsAuthMiddlewareOptions);\n  }\n});\nexport const getSigV4AuthPlugin = getAwsAuthPlugin;","map":{"version":3,"names":["HttpRequest","HttpResponse","getSkewCorrectedDate","getUpdatedSystemClockOffset","awsAuthMiddleware","options","next","context","args","isInstance","request","authScheme","endpointV2","properties","authSchemes","multiRegionOverride","name","signingRegionSet","join","undefined","signer","output","sign","signingDate","systemClockOffset","signingRegion","signingService","catch","error","serverTime","ServerTime","getDateHeader","$response","dateHeader","response","headers","date","Date","awsAuthMiddlewareOptions","tags","relation","toMiddleware","override","getAwsAuthPlugin","applyToStack","clientStack","addRelativeTo","getSigV4AuthPlugin"],"sources":["C:/Users/anshs/OneDrive/Documents/Code/WebDevelopement/portfolioPersonal/node_modules/@aws-sdk/middleware-signing/dist-es/middleware.js"],"sourcesContent":["import { HttpRequest, HttpResponse } from \"@aws-sdk/protocol-http\";\nimport { getSkewCorrectedDate } from \"./utils/getSkewCorrectedDate\";\nimport { getUpdatedSystemClockOffset } from \"./utils/getUpdatedSystemClockOffset\";\nexport const awsAuthMiddleware = (options) => (next, context) => async function (args) {\n    if (!HttpRequest.isInstance(args.request))\n        return next(args);\n    const authScheme = context.endpointV2?.properties?.authSchemes?.[0];\n    const multiRegionOverride = authScheme?.name === \"sigv4a\" ? authScheme?.signingRegionSet?.join(\",\") : undefined;\n    const signer = await options.signer(authScheme);\n    const output = await next({\n        ...args,\n        request: await signer.sign(args.request, {\n            signingDate: getSkewCorrectedDate(options.systemClockOffset),\n            signingRegion: multiRegionOverride || context[\"signing_region\"],\n            signingService: context[\"signing_service\"],\n        }),\n    }).catch((error) => {\n        const serverTime = error.ServerTime ?? getDateHeader(error.$response);\n        if (serverTime) {\n            options.systemClockOffset = getUpdatedSystemClockOffset(serverTime, options.systemClockOffset);\n        }\n        throw error;\n    });\n    const dateHeader = getDateHeader(output.response);\n    if (dateHeader) {\n        options.systemClockOffset = getUpdatedSystemClockOffset(dateHeader, options.systemClockOffset);\n    }\n    return output;\n};\nconst getDateHeader = (response) => HttpResponse.isInstance(response) ? response.headers?.date ?? response.headers?.Date : undefined;\nexport const awsAuthMiddlewareOptions = {\n    name: \"awsAuthMiddleware\",\n    tags: [\"SIGNATURE\", \"AWSAUTH\"],\n    relation: \"after\",\n    toMiddleware: \"retryMiddleware\",\n    override: true,\n};\nexport const getAwsAuthPlugin = (options) => ({\n    applyToStack: (clientStack) => {\n        clientStack.addRelativeTo(awsAuthMiddleware(options), awsAuthMiddlewareOptions);\n    },\n});\nexport const getSigV4AuthPlugin = getAwsAuthPlugin;\n"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,YAAtB,QAA0C,wBAA1C;AACA,SAASC,oBAAT,QAAqC,8BAArC;AACA,SAASC,2BAAT,QAA4C,qCAA5C;AACA,OAAO,MAAMC,iBAAiB,GAAIC,OAAD,IAAa,CAACC,IAAD,EAAOC,OAAP,KAAmB,gBAAgBC,IAAhB,EAAsB;EACnF,IAAI,CAACR,WAAW,CAACS,UAAZ,CAAuBD,IAAI,CAACE,OAA5B,CAAL,EACI,OAAOJ,IAAI,CAACE,IAAD,CAAX;EACJ,MAAMG,UAAU,GAAGJ,OAAO,CAACK,UAAR,EAAoBC,UAApB,EAAgCC,WAAhC,GAA8C,CAA9C,CAAnB;EACA,MAAMC,mBAAmB,GAAGJ,UAAU,EAAEK,IAAZ,KAAqB,QAArB,GAAgCL,UAAU,EAAEM,gBAAZ,EAA8BC,IAA9B,CAAmC,GAAnC,CAAhC,GAA0EC,SAAtG;EACA,MAAMC,MAAM,GAAG,MAAMf,OAAO,CAACe,MAAR,CAAeT,UAAf,CAArB;EACA,MAAMU,MAAM,GAAG,MAAMf,IAAI,CAAC,EACtB,GAAGE,IADmB;IAEtBE,OAAO,EAAE,MAAMU,MAAM,CAACE,IAAP,CAAYd,IAAI,CAACE,OAAjB,EAA0B;MACrCa,WAAW,EAAErB,oBAAoB,CAACG,OAAO,CAACmB,iBAAT,CADI;MAErCC,aAAa,EAAEV,mBAAmB,IAAIR,OAAO,CAAC,gBAAD,CAFR;MAGrCmB,cAAc,EAAEnB,OAAO,CAAC,iBAAD;IAHc,CAA1B;EAFO,CAAD,CAAJ,CAOlBoB,KAPkB,CAOXC,KAAD,IAAW;IAChB,MAAMC,UAAU,GAAGD,KAAK,CAACE,UAAN,IAAoBC,aAAa,CAACH,KAAK,CAACI,SAAP,CAApD;;IACA,IAAIH,UAAJ,EAAgB;MACZxB,OAAO,CAACmB,iBAAR,GAA4BrB,2BAA2B,CAAC0B,UAAD,EAAaxB,OAAO,CAACmB,iBAArB,CAAvD;IACH;;IACD,MAAMI,KAAN;EACH,CAboB,CAArB;EAcA,MAAMK,UAAU,GAAGF,aAAa,CAACV,MAAM,CAACa,QAAR,CAAhC;;EACA,IAAID,UAAJ,EAAgB;IACZ5B,OAAO,CAACmB,iBAAR,GAA4BrB,2BAA2B,CAAC8B,UAAD,EAAa5B,OAAO,CAACmB,iBAArB,CAAvD;EACH;;EACD,OAAOH,MAAP;AACH,CAzBM;;AA0BP,MAAMU,aAAa,GAAIG,QAAD,IAAcjC,YAAY,CAACQ,UAAb,CAAwByB,QAAxB,IAAoCA,QAAQ,CAACC,OAAT,EAAkBC,IAAlB,IAA0BF,QAAQ,CAACC,OAAT,EAAkBE,IAAhF,GAAuFlB,SAA3H;;AACA,OAAO,MAAMmB,wBAAwB,GAAG;EACpCtB,IAAI,EAAE,mBAD8B;EAEpCuB,IAAI,EAAE,CAAC,WAAD,EAAc,SAAd,CAF8B;EAGpCC,QAAQ,EAAE,OAH0B;EAIpCC,YAAY,EAAE,iBAJsB;EAKpCC,QAAQ,EAAE;AAL0B,CAAjC;AAOP,OAAO,MAAMC,gBAAgB,GAAItC,OAAD,KAAc;EAC1CuC,YAAY,EAAGC,WAAD,IAAiB;IAC3BA,WAAW,CAACC,aAAZ,CAA0B1C,iBAAiB,CAACC,OAAD,CAA3C,EAAsDiC,wBAAtD;EACH;AAHyC,CAAd,CAAzB;AAKP,OAAO,MAAMS,kBAAkB,GAAGJ,gBAA3B"},"metadata":{},"sourceType":"module"}